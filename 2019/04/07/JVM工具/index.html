<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="哲锄">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="https://zhechu.github.io">
    <!--SEO-->

    <meta name="keywords" content="JVM,工具,">


    <meta name="description" content="1 JPS官方文档
https://docs.oracle.com/javase/7/docs/technotes/tools/share/jps.html
作用：查看 Java 程序运行状态。
1.1 查看帮助1$ jps --help




参数
说明




m
运行时传入主类的参数
...">


<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->


<title>JVM工具 | 哲锄</title>


    <link rel="alternate" href="/atom.xml" title="哲锄" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    





    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="https://zhechu.github.io">哲锄</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa fa-home"></i>哲锄</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories"><i class="fa fa-list"></i>分类</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/about"><i class="fa fa-user"></i>关于我</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives"><i class="fa fa-archive"></i>归档</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

<a href="http://github.com/zhechu">
    <img style="position: absolute; top: 0; right: 0; border: 0;"
        src="/img/forkme.png"
        alt="Fork me on GitHub">
</a>

    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="JVM工具">
            
                JVM工具
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/Java">
            Java
        </a>
    </span>
    

    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/JVM" title='JVM'>
                        JVM
                    </a>
                
                    <a href="/tags/工具" title='工具'>
                        工具
                    </a>
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/04/07</span>
        </span>
        
            <span class="fa-wrap">
                <i class="fa fa-eye"></i>
                <span id="busuanzi_value_page_pv"></span>
            </span>
        
    
</div>

        
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="1-JPS"><a href="#1-JPS" class="headerlink" title="1 JPS"></a>1 JPS</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jps.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/share/jps.html</a></p>
<p>作用：查看 Java 程序运行状态。</p>
<h3 id="1-1-查看帮助"><a href="#1-1-查看帮助" class="headerlink" title="1.1 查看帮助"></a>1.1 查看帮助</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jps --help</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jps_help.png" alt></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>m</td>
<td>运行时传入主类的参数</td>
</tr>
<tr>
<td>l</td>
<td>运行的主类全名</td>
</tr>
<tr>
<td>v</td>
<td>虚拟机参数</td>
</tr>
</tbody>
</table>
<h3 id="1-2-查看所有-Java-进程的-PID"><a href="#1-2-查看所有-Java-进程的-PID" class="headerlink" title="1.2 查看所有 Java 进程的 PID"></a>1.2 查看所有 Java 进程的 PID</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jps -mlvV</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jps_mlvV.png" alt></p>
<h2 id="2-JSTAT"><a href="#2-JSTAT" class="headerlink" title="2 JSTAT"></a>2 JSTAT</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jstat.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/share/jstat.html</a></p>
<p>作用：Java 虚拟机统计监视工具。</p>
<h3 id="2-1-查看-Java-进程的-GC-情况"><a href="#2-1-查看-Java-进程的-GC-情况" class="headerlink" title="2.1 查看 Java 进程的 GC 情况"></a>2.1 查看 Java 进程的 GC 情况</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jstat -gcutil 6476</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jstat_gcutil.png" alt></p>
<h3 id="2-2-监控10次-GC，每隔1秒打印一次"><a href="#2-2-监控10次-GC，每隔1秒打印一次" class="headerlink" title="2.2 监控10次 GC，每隔1秒打印一次"></a>2.2 监控10次 GC，每隔1秒打印一次</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jstat -gcutil 6476 1000 10</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jstat_gcutil_interval.png" alt></p>
<h2 id="3-JINFO"><a href="#3-JINFO" class="headerlink" title="3 JINFO"></a>3 JINFO</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jinfo.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/share/jinfo.html</a></p>
<p>作用：实时查看和动态调整虚拟机各项参数。</p>
<h3 id="3-1-查看-Java-程序是否使用串行化收集器"><a href="#3-1-查看-Java-程序是否使用串行化收集器" class="headerlink" title="3.1 查看 Java 程序是否使用串行化收集器"></a>3.1 查看 Java 程序是否使用串行化收集器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jinfo -flag UseSerialGC 3120</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jinfo_flag.png" alt></p>
<h3 id="3-2-查看虚拟机参数"><a href="#3-2-查看虚拟机参数" class="headerlink" title="3.2 查看虚拟机参数"></a>3.2 查看虚拟机参数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jinfo -flags 3120</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jinfo_search_param.png" alt></p>
<h3 id="3-3-查看系统配置信息"><a href="#3-3-查看系统配置信息" class="headerlink" title="3.3 查看系统配置信息"></a>3.3 查看系统配置信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jinfo -sysprops 6476</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jinfo_search_config.png" alt></p>
<h2 id="4-JMAP"><a href="#4-JMAP" class="headerlink" title="4 JMAP"></a>4 JMAP</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jmap.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/share/jmap.html</a></p>
<p>作用：导出 Java 程序内存映射信息。</p>
<h3 id="4-1-导出-JConsole-内存映射信息"><a href="#4-1-导出-JConsole-内存映射信息" class="headerlink" title="4.1 导出 JConsole 内存映射信息"></a>4.1 导出 JConsole 内存映射信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jmap -dump:format=b,file=d:\jconsole.dump 6476</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jmap_dump.png" alt></p>
<blockquote>
<p>TIPS：可以使用 Eclipse Memory Analyzer 分析导出的文件。</p>
</blockquote>
<h3 id="4-2-查看当前存活的对象"><a href="#4-2-查看当前存活的对象" class="headerlink" title="4.2 查看当前存活的对象"></a>4.2 查看当前存活的对象</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jmap -histo:live 6588</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jmap_histo.png" alt></p>
<h2 id="5-JHAT"><a href="#5-JHAT" class="headerlink" title="5 JHAT"></a>5 JHAT</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jhat.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/share/jhat.html</a></p>
<p>作用：堆分析工具。</p>
<h3 id="5-1-通过-jmap-导出内存映射文件"><a href="#5-1-通过-jmap-导出内存映射文件" class="headerlink" title="5.1 通过 jmap 导出内存映射文件"></a>5.1 通过 jmap 导出内存映射文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jmap -dump:format=b,file=d:\app.dump 2848</span><br></pre></td></tr></table></figure>
<p>使用 jhat 分析内存映射文件<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jhat d:\app.dump</span><br></pre></td></tr></table></figure></p>
<p><img src="/2019/04/07/JVM工具/jhat_analysis.png" alt></p>
<p>浏览器访问</p>
<p><a href="http://127.0.0.1:7000/" target="_blank" rel="noopener">http://127.0.0.1:7000/</a></p>
<p><img src="/2019/04/07/JVM工具/jhat_browser_access.png" alt></p>
<h2 id="6-JSTACK"><a href="#6-JSTACK" class="headerlink" title="6 JSTACK"></a>6 JSTACK</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/share/jstack.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/share/jstack.html</a></p>
<p>作用：堆栈跟踪工具。</p>
<h3 id="6-1-查看线程的堆栈跟踪信息"><a href="#6-1-查看线程的堆栈跟踪信息" class="headerlink" title="6.1 查看线程的堆栈跟踪信息"></a>6.1 查看线程的堆栈跟踪信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jstack -l 2848</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/jstack_l.png" alt></p>
<h2 id="7-JAVAP"><a href="#7-JAVAP" class="headerlink" title="7 JAVAP"></a>7 JAVAP</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/windows/javap.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/technotes/tools/windows/javap.html</a></p>
<p>作用：Java 类文件反汇编程序。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td>显示所有类和成员</td>
</tr>
<tr>
<td>v</td>
<td>显示尽可能多的信息</td>
</tr>
</tbody>
</table>
<h3 id="7-1-查看-class-文件反汇编结果"><a href="#7-1-查看-class-文件反汇编结果" class="headerlink" title="7.1 查看 .class 文件反汇编结果"></a>7.1 查看 .class 文件反汇编结果</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> javap -verbose D:\mywork\wise_workspace\jvm-test\bin\com\wise\stack\InvokeTest.class</span><br></pre></td></tr></table></figure>
<p><img src="/2019/04/07/JVM工具/javap_verbose.png" alt></p>
<h2 id="8-VisualVM"><a href="#8-VisualVM" class="headerlink" title="8 VisualVM"></a>8 VisualVM</h2><p>官方文档</p>
<p><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/index.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/index.html</a></p>
<p>插件</p>
<p><a href="https://visualvm.github.io/pluginscenters.html" target="_blank" rel="noopener">https://visualvm.github.io/pluginscenters.html</a></p>
<p>作用：JVM 强大的可视化监控工具。</p>
<h2 id="9-JConsole"><a href="#9-JConsole" class="headerlink" title="9 JConsole"></a>9 JConsole</h2><p>进入<strong>jdk1.8.0_45_64bit\bin</strong>目录双击<strong>jconsole.exe</strong>即可启动监控程序<br><img src="/2019/04/07/JVM工具/jconsole_1.png" alt></p>
<p>启动成功界面<br><img src="/2019/04/07/JVM工具/jconsole_2.png" alt></p>
<h3 id="9-1-监控示例"><a href="#9-1-监控示例" class="headerlink" title="9.1 监控示例"></a>9.1 监控示例</h3><h4 id="9-1-1-本地监控"><a href="#9-1-1-本地监控" class="headerlink" title="9.1.1 本地监控"></a>9.1.1 本地监控</h4><p>示例：监控本地 Spring Boo t程序。</p>
<p>打开监控首页后，选择本地进程（PID为进程号）<br><img src="/2019/04/07/JVM工具/jconsole_3.png" alt></p>
<p>为了方便使用，没有开启SSL，选中不安全连接进入监控<br><img src="/2019/04/07/JVM工具/jconsole_4.png" alt></p>
<p>成功打开监控界面<br><img src="/2019/04/07/JVM工具/jconsole_5.png" alt></p>
<h4 id="9-1-2-远程监控"><a href="#9-1-2-远程监控" class="headerlink" title="9.1.2 远程监控"></a>9.1.2 远程监控</h4><p>示例：监控远程主机上的 Spring Boot 程序（Spring Boot 程序和 JConsole 不在同一台机器上）。</p>
<p>监控前，要给被监控的程序配置 JVM 参数<br><img src="/2019/04/07/JVM工具/jconsole_6.png" alt><br><img src="/2019/04/07/JVM工具/jconsole_7.png" alt></p>
<p><strong>JVM 参数如下</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-Djava.rmi.server.hostname=172.22.2.146</span><br><span class="line">-Dcom.sun.management.jmxremote=true</span><br><span class="line">-Dcom.sun.management.jmxremote.port=12345</span><br><span class="line">-Dcom.sun.management.jmxremote.rmi.port=12345</span><br><span class="line">-Dcom.sun.management.jmxremote.ssl=false</span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate=false</span><br></pre></td></tr></table></figure></p>
<p>配置完后，启动 Spring Boot 程序。打开 JConsole 监控首页后，选择远程进程（<strong>IP 为-Djava.rmi.server.hostname，PORT 为-Dcom.sun.management.jmxremote.port</strong>）<br><img src="/2019/04/07/JVM工具/jconsole_8.png" alt><br><img src="/2019/04/07/JVM工具/jconsole_9.png" alt></p>
<p>成功打开监控界面<br><img src="/2019/04/07/JVM工具/jconsole_10.png" alt></p>
<h2 id="10-JMC"><a href="#10-JMC" class="headerlink" title="10 JMC"></a>10 JMC</h2><h2 id="11-NMT"><a href="#11-NMT" class="headerlink" title="11 NMT"></a>11 NMT</h2><p>参考博文</p>
<p><a href="https://www.cnblogs.com/helloz/p/11582109.html" target="_blank" rel="noopener">https://www.cnblogs.com/helloz/p/11582109.html</a></p>
<h2 id="12-ASMTools"><a href="#12-ASMTools" class="headerlink" title="12 ASMTools"></a>12 ASMTools</h2><p>字节码汇编器反汇编器。</p>
<p><a href="http://openjdk.java.net/projects/code-tools/" target="_blank" rel="noopener">http://openjdk.java.net/projects/code-tools/</a></p>
<h2 id="13-JOL"><a href="#13-JOL" class="headerlink" title="13 JOL"></a>13 JOL</h2><p>查看 JVM 中对象的内存分布情况。</p>
<p><a href="http://openjdk.java.net/projects/code-tools/" target="_blank" rel="noopener">http://openjdk.java.net/projects/code-tools/</a></p>
<h2 id="14-ASM-字节码框架"><a href="#14-ASM-字节码框架" class="headerlink" title="14 ASM 字节码框架"></a>14 ASM 字节码框架</h2><p>字节码分析及修改框架。</p>
<p><a href="https://asm.ow2.io/" target="_blank" rel="noopener">https://asm.ow2.io/</a></p>
<h2 id="15-Arthas"><a href="#15-Arthas" class="headerlink" title="15 Arthas"></a>15 Arthas</h2><p>官方文档</p>
<p><a href="https://arthas.aliyun.com/" target="_blank" rel="noopener">https://arthas.aliyun.com/</a></p>
<p>开源案例</p>
<p><a href="https://github.com/alibaba/arthas/issues?q=label%3Auser-case" target="_blank" rel="noopener">https://github.com/alibaba/arthas/issues?q=label%3Auser-case</a></p>
<h3 id="15-1-热更新代码"><a href="#15-1-热更新代码" class="headerlink" title="15.1 热更新代码"></a>15.1 热更新代码</h3><h4 id="51-1-1-在线添加打印日志代码"><a href="#51-1-1-在线添加打印日志代码" class="headerlink" title="51.1.1 在线添加打印日志代码"></a>51.1.1 在线添加打印日志代码</h4><p>导出源码<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jad --source-only service.impl.OauthServiceImpl &gt; /tmp OauthServiceImpl.java</span><br></pre></td></tr></table></figure></p>
<p>编辑源码<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> vim /tmp/OauthServiceImpl.java</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dto.OauthTokenDTO;</span><br><span class="line"><span class="keyword">import</span> rpc.feign.OauthFeign;</span><br><span class="line"><span class="keyword">import</span> service.OauthService;</span><br><span class="line"><span class="keyword">import</span> vo.OauthTokenVO;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OauthServiceImpl</span></span></span><br><span class="line"><span class="class"><span class="keyword">implements</span> <span class="title">OauthService</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> OauthFeign oauthFeign;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> OauthTokenVO <span class="title">oauthToken</span><span class="params">(OauthTokenDTO oauthTokenDTO)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO 添加打印日志代码</span></span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.oauthFeign.oauthToken(oauthTokenDTO);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">OauthServiceImpl</span><span class="params">(OauthFeign oauthFeign)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.oauthFeign = oauthFeign;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>获取类的加载器<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> sc -d *OauthServiceImpl</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>TIPS：得到类的加载器为<code>org.springframework.boot.loader.LaunchedURLClassLoader</code></p>
</blockquote>
<p>编译修改过的源码<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> mc --classLoaderClass org.springframework.boot.loader.LaunchedURLClassLoader /tmp/OauthServiceImpl.java -d /tmp</span><br></pre></td></tr></table></figure></p>
<p>重新加载编译过的代码<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> redefine /tmp/service/impl/OauthServiceImpl.class</span><br></pre></td></tr></table></figure></p>
<p>重置热更新的代码（诊断完毕后恢复原状）<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> reset</span><br></pre></td></tr></table></figure></p>
<h3 id="15-2-反编译代码"><a href="#15-2-反编译代码" class="headerlink" title="15.2 反编译代码"></a>15.2 反编译代码</h3><h4 id="15-2-1-版本确认"><a href="#15-2-1-版本确认" class="headerlink" title="15.2.1 版本确认"></a>15.2.1 版本确认</h4><p>反编译代码（确认某个类部署的版本是否与预期一致）<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jad service.impl.UserServiceImpl</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>TIPS：可以确认部署的版本是否是最新的</p>
</blockquote>
<h3 id="15-3-确认方法入参与出参"><a href="#15-3-确认方法入参与出参" class="headerlink" title="15.3 确认方法入参与出参"></a>15.3 确认方法入参与出参</h3><h4 id="15-3-1-入参过滤"><a href="#15-3-1-入参过滤" class="headerlink" title="15.3.1 入参过滤"></a>15.3.1 入参过滤</h4><p>满足入参 username 为 <strong>zhechu</strong> 才捕获<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> watch service.impl.OauthServiceImpl oauthToken "&#123;params,target,returnObj&#125;" "params[0].username==\"zhechu\"" -x 2</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>TIPS：<code>-x 2</code>表示指定输出结果的属性遍历深度为2</p>
</blockquote>
<h4 id="15-3-2-耗时过滤"><a href="#15-3-2-耗时过滤" class="headerlink" title="15.3.2 耗时过滤"></a>15.3.2 耗时过滤</h4><p>满足耗时大于<strong>200毫秒</strong>才捕获<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> watch service.impl.OauthServiceImpl oauthToken "&#123;params,target,returnObj&#125;" '#cost&gt;200' -x 2</span><br></pre></td></tr></table></figure></p>
<h4 id="15-3-3-异常过滤"><a href="#15-3-3-异常过滤" class="headerlink" title="15.3.3 异常过滤"></a>15.3.3 异常过滤</h4><p><strong>异常时</strong>才捕获<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> watch service.impl.OauthServiceImpl oauthToken "&#123;params,target,throwExp&#125;" -e</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>TIPS：<code>-e</code>表示在方法异常之后观察</p>
</blockquote>
<h3 id="15-4-查看系统信息"><a href="#15-4-查看系统信息" class="headerlink" title="15.4 查看系统信息"></a>15.4 查看系统信息</h3><p>查看所有的System Properties信息<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> sysprop</span><br></pre></td></tr></table></figure></p>
<p>查看所有环境变量<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> sysenv</span><br></pre></td></tr></table></figure></p>
<p>查看 jvm 信息<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> jvm</span><br></pre></td></tr></table></figure></p>
<p>实时面板<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> dashboard</span><br></pre></td></tr></table></figure></p>

    </div>
    
    <div class="post-footer">
        <div class="col-sm-10">
            <div>
                <b>本文链接</b>：<a href="/2019/04/07/JVM工具/">JVM工具</a>
            </div>
            <div>
                
                    转载声明：本博客由<strong>哲锄</strong>创作，采用 <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank"> CC BY 3.0 CN </a> 许可协议。可自由转载、引用，但需署名作者且注明文章出处。如转载至微信公众号，请在文末添加作者公众号二维码。
                
            </div>
            <div>
                
            </div>
        </div>
        <div class="col-sm-2">
            <img src="" width=100%/>
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2019/04/07/Java性能调优案例/" class="pre-post btn btn-default" title='Java性能调优案例'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Java性能调优案例</span>
        </a>
    
    
        <a href="/2019/04/06/JVM备忘及性能调优/" class="next-post btn btn-default" title='JVM备忘'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">JVM备忘</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>






                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-JPS"><span class="toc-text">1 JPS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-查看帮助"><span class="toc-text">1.1 查看帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-查看所有-Java-进程的-PID"><span class="toc-text">1.2 查看所有 Java 进程的 PID</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-JSTAT"><span class="toc-text">2 JSTAT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-查看-Java-进程的-GC-情况"><span class="toc-text">2.1 查看 Java 进程的 GC 情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-监控10次-GC，每隔1秒打印一次"><span class="toc-text">2.2 监控10次 GC，每隔1秒打印一次</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-JINFO"><span class="toc-text">3 JINFO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-查看-Java-程序是否使用串行化收集器"><span class="toc-text">3.1 查看 Java 程序是否使用串行化收集器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-查看虚拟机参数"><span class="toc-text">3.2 查看虚拟机参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-查看系统配置信息"><span class="toc-text">3.3 查看系统配置信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-JMAP"><span class="toc-text">4 JMAP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-导出-JConsole-内存映射信息"><span class="toc-text">4.1 导出 JConsole 内存映射信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-查看当前存活的对象"><span class="toc-text">4.2 查看当前存活的对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-JHAT"><span class="toc-text">5 JHAT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-通过-jmap-导出内存映射文件"><span class="toc-text">5.1 通过 jmap 导出内存映射文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-JSTACK"><span class="toc-text">6 JSTACK</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-查看线程的堆栈跟踪信息"><span class="toc-text">6.1 查看线程的堆栈跟踪信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-JAVAP"><span class="toc-text">7 JAVAP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-查看-class-文件反汇编结果"><span class="toc-text">7.1 查看 .class 文件反汇编结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-VisualVM"><span class="toc-text">8 VisualVM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-JConsole"><span class="toc-text">9 JConsole</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-监控示例"><span class="toc-text">9.1 监控示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-1-本地监控"><span class="toc-text">9.1.1 本地监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-2-远程监控"><span class="toc-text">9.1.2 远程监控</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-JMC"><span class="toc-text">10 JMC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-NMT"><span class="toc-text">11 NMT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-ASMTools"><span class="toc-text">12 ASMTools</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-JOL"><span class="toc-text">13 JOL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-ASM-字节码框架"><span class="toc-text">14 ASM 字节码框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Arthas"><span class="toc-text">15 Arthas</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#15-1-热更新代码"><span class="toc-text">15.1 热更新代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#51-1-1-在线添加打印日志代码"><span class="toc-text">51.1.1 在线添加打印日志代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2-反编译代码"><span class="toc-text">15.2 反编译代码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#15-2-1-版本确认"><span class="toc-text">15.2.1 版本确认</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-3-确认方法入参与出参"><span class="toc-text">15.3 确认方法入参与出参</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#15-3-1-入参过滤"><span class="toc-text">15.3.1 入参过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-3-2-耗时过滤"><span class="toc-text">15.3.2 耗时过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-3-3-异常过滤"><span class="toc-text">15.3.3 异常过滤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-4-查看系统信息"><span class="toc-text">15.4 查看系统信息</span></a></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
        访问量:
        <strong id="busuanzi_value_site_pv">
            <i class="fa fa-spinner fa-spin"></i>
        </strong>
        &nbsp; | &nbsp;
        访客数:
        <strong id="busuanzi_value_site_uv">
            <i class="fa fa-spinner fa-spin"></i>
        </strong>
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2016
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/itmuch/hexo-theme-itmuch.git" class="copyright-links" target="_blank" rel="nofollow">ITMuch</a>
                </span>
            </div>
        </div>
    </div>
</div>






    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>